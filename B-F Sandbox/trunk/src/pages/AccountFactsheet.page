<apex:page controller="AccountFactsheet" renderAs="{!$CurrentPage.parameters.renderas}" sidebar="false" showHeader="false" language="{!$CurrentPage.parameters.Lang}" id="factsheetpage">
<apex:includeScript value="{!$Resource.JQuery17}"/>
<script type="text/javascript">
	$n = jQuery.noConflict(); 
	var pageH = 1200;
	var page = 1;
	//jQuery(document).ready( 
	$n(function() {
		var $element = $n('[id$=section_contact]');
		$element.parent().css('vertical-align','top');
		
		var $div = $n('#firstDiv');
		if($div != null) {
			var position = $div.offset().top;
			if(position+$div.height() > pageH*page) { 
				$div.css('page-break-before', 'always');
				
				var i = position+$div.height() / pageH*page;
				while(i>=1) {
					page++;
					i--;
				}
			}
		}
			
		$div = $n('#secDiv');
		if($div != null) {
			var position = $div.offset().top;
			if(position+$div.height() > pageH*page) {
				$div.css('page-break-before', 'always');
				
				var i = position+$div.height() / pageH*page;
				while(i>=1) {
					page++;
					i--;
				}
			}
		}
		
		$div = $n('#thirdDiv');
		if($div != null) {
			var position = $div.offset().top;
			if(position+$div.height() > pageH*page) {
				$div.css('page-break-before', 'always');
				
				var i = position+$div.height() / pageH*page;
				while(i>=1) {
					page++;
					i--;
				}
			}
		}
		
		$div = $n('#fourthDiv');
		if($div != null) {
			var position = $div.offset().top;
			if(position+$div.height() > pageH*page) {
				$div.css('page-break-before', 'always');
				
				var i = position+$div.height() / pageH*page;
				while(i>=1) {
					page++;
					i--;
				}
			}
		}
		
		$div = $n('#fivthDiv');
		if($div != null) {
			var position = $div.offset().top;
			if(position+$div.height() > pageH*page) {
				$div.css('page-break-before', 'always');
				
				var i = position+$div.height() / pageH*page;
				while(i>=1) {
					page++;
					i--;
				}
			}
		}
			
		$div = $n('#sixthDiv');
		if($div != null) {
			var position = $div.offset().top;
			if(position+$div.height() > pageH*page) {
				$div.css('page-break-before', 'always');
				
				var i = position+$div.height() / pageH*page;
				while(i>=1) {
					page++;
					i--;
				}
			}
		}	
		
		$div = $n('#seventhDiv');
		if($div != null) {
			var position = $div.offset().top;
			if(position+$div.height() > pageH*page) {
				$div.css('page-break-before', 'always');
				
				var i = position+$div.height() / pageH*page;
				while(i>=1) {
					page++;
					i--;
				}
			}
		}
	});
</script>

<style type="text/css">
	.marked-horizontal tr:nth-child(odd) {background-color: white; }
	.marked-horizontal tr:nth-child(even) {background-color: #eeeeee; } 
	 
	.even {background: #eeeeee; }
	.odd {} 
</style>

<div style="width:19cm; font-size:12px; position:relative; ">
	
	<div id="firstDiv" style="{!IF($CurrentPage.parameters.renderas != 'pdf','','border-top-style: solid; border-top-width:1px;')}">  
	    <apex:outputLink onclick="javascript:print(); return false;" style="padding-left: 10px; float:right;" value="#" rendered="{!$CurrentPage.parameters.renderas != 'pdf'}">{!$Label.Factsheet_Print}</apex:outputLink>
	    <apex:outputLink value="?AccountId={!account.ID}&renderas=pdf#" style="float:right;" rendered="{!$CurrentPage.parameters.renderas != 'pdf'}">{!$Label.Factsheet_PDF}</apex:outputLink>
	   
	    <apex:pageblock title="{!$Label.Factsheet_AccountInfo}">
	    	<table style="width:100%;">
	    		<thead>
	    			<tr>
	    				<td><h2>{!$Label.Accounts}</h2></td>
	    				<td><h2>{!$Label.Contacts}</h2></td>
	    			</tr> 
	    		</thead>
	    		<tbody>
	    			<tr>
	    				<td  style="vertical-align:top;">
	    					<apex:outputText id="name" value="{!account.Name}" /> <br />
	    					<apex:outputText id="street" value="{!account.BillingStreet}" /> <br /> <br />
	    					
	    					<b> <apex:outputText id="phoneLabel" value="{!$ObjectType.Account.Fields.Phone.Label}:" /> </b>
	    					<apex:outputText id="phone" value="{!account.Phone}" /> <br />
	    					
	    					<b> <apex:outputText id="faxLabel" value="{!$ObjectType.Account.Fields.Fax.Label}:" /> </b>
	    					<apex:outputText id="fax" value="{!account.Fax}" /> <br />
	    					
	    					<b> <apex:outputText id="classLabel" value="{!$ObjectType.Outlet_Class__c.Fields.Name.Label}:" /> </b>
		    				<apex:outputText id="class" value="{!account.Outlet_Class__r.Name}" /> <br />
		    				
		    				<b> <apex:outputText id="channelLabel" value="{!$ObjectType.Account.Fields.Channel__c.Label}:" /> </b>
		    				<apex:outputText id="channel" value="{!account.Channel__c}" /> <br />
		    				
		    				<b> <apex:outputText id="groupLabel" value="{!$ObjectType.Account.Fields.Group__c.Label}:" rendered="{!isChannelOn}"/> </b>
		    				<apex:outputText id="group" value="{!account.Group__c}" rendered="{!isChannelOn}" /> <br />
	    					
	    					<b> <apex:outputText id="subgroupLabel" value="{!$ObjectType.Account.Fields.Subgroup__c.Label}:" rendered="{!isChannelOn}" /> </b>
	    					<apex:outputText id="subgroup" value="{!account.Subgroup__c}" rendered="{!isChannelOn}" /> <br />
	    					
	    					<b> <apex:outputText id="storetypeLabel" value="{!$ObjectType.Account.Fields.Store_Type_TD__c.Label}:" rendered="{!isChannelOff}"/> </b>
	    					<apex:outputText id="storetype" value="{!account.Store_Type_TD__c}" rendered="{!isChannelOff}" />
	    				</td>
	    				
	    				<td style="vertical-align:top;">
	    					<apex:dataTable value="{!contact}" var="con" style="width:100%; height:100%;" rowClasses="odd,even" styleClass="tableClass">
			    				<apex:column >
			    					<apex:facet name="header">{!$ObjectType.Contact.Fields.Salutation.Label}</apex:facet>
			    					<apex:outputField value="{!con.Salutation}"/>
			    				</apex:column>
			    				<apex:column >
			    					<apex:facet name="header">{!$ObjectType.Contact.Fields.FirstName.Label}</apex:facet>
			    					<apex:outputField value="{!con.FirstName}"/>
			    				</apex:column>
			    				<apex:column >
			    					<apex:facet name="header">{!$ObjectType.Contact.Fields.LastName.Label}</apex:facet>
			    					<apex:outputField value="{!con.LastName}"/>
			    				</apex:column>
			    				<apex:column >
			    					<apex:facet name="header">{!$ObjectType.Contact.Fields.Email.Label}</apex:facet>
			    					<apex:outputField value="{!con.Email}"/>
			    				</apex:column>
			    				<apex:column >
			    					<apex:facet name="header">{!$Label.Factsheet_Contact_Function}</apex:facet>
			    					<apex:outputField value="{!con.Title__c}"/>
			    				</apex:column>
			    			</apex:dataTable>
	    				</td>
	    			</tr>
	    		</tbody>
	    	</table>
	    </apex:pageblock>
	</div>
	
    <br />
    <br />
    
    <div id="secDiv" style="{!IF($CurrentPage.parameters.renderas != 'pdf','','border-top-style: solid; border-top-width:1px;')}">
    	<apex:pageblock title="{!$Label.Factsheet_LastVisitComments}">
    		<apex:dataTable value="{!Outlet_Visit}" var="OV" style="width:100%; height:100%;" rowClasses="odd,even" styleClass="tableClass">
   				<apex:column >
   					<apex:facet name="header">{!$ObjectType.Outlet_Visit__c.Fields.LastModifiedDate.Label}</apex:facet>
   					<apex:outputField value="{!OV.Last_Visit_Date__c}"/>
   				</apex:column>
   				<apex:column >
   					<apex:facet name="header">{!$ObjectType.Outlet_Visit__c.Fields.Visit_Comments__c.Label}</apex:facet>
   					<apex:outputField value="{!OV.Visit_Comments__c}"/>
   				</apex:column>
   			</apex:dataTable>
    	</apex:pageblock>
    </div>
    
    <br/>
    <br />
    
    <apex:outputPanel rendered="{!NOT(isChannelOff)}">
    <div id="thirdDiv" style="{!IF($CurrentPage.parameters.renderas != 'pdf','','border-top-style: solid; border-top-width:1px;')}">
    	<apex:pageBlock title="{!$Label.Factsheet_KeyTask}">
    		<apex:dataTable value="{!Key_Task}" var="KT" style="width:100%; height:100%;" rowClasses="odd,even" styleClass="tableClass">
   				<apex:column >
   					<apex:facet name="header">{!$ObjectType.Key_Task__c.Fields.Name.Label}</apex:facet>
   					<apex:outputField value="{!KT.Name}"/> 
   				</apex:column>
   				<apex:column >
   					<apex:facet name="header">{!$ObjectType.Outlet_Visit__c.Fields.Visit_Date__c.Label}</apex:facet>
   					<apex:outputField value="{!KT.Outlet_Visit__r.Visit_Date__c}"/> 
   				</apex:column>
   			</apex:dataTable>
    	</apex:pageBlock>
	</div>
	<br />
	<br />
	</apex:outputPanel>
	
	<div id="fourthDiv" style="{!IF($CurrentPage.parameters.renderas != 'pdf','','border-top-style: solid; border-top-width:1px;')}">
		<apex:pageBlock title="{!$Label.Factsheet_AccountProduct}">
			<apex:dataTable value="{!Account_Product}" var="AP" style="width:100%; height:100%;" rowClasses="odd,even" styleClass="tableClass">
   				<apex:column >
   					<apex:facet name="header">{!$ObjectType.Account_Product__c.Fields.Brand__c.Label}</apex:facet>
   					<i><apex:outputField value="{!AP.Brand__c}"/></i> 
   				</apex:column>
   				<apex:column >
   					<apex:facet name="header">{!$ObjectType.Account_Product__c.Fields.Product__c.Label}</apex:facet>
   					<apex:outputField value="{!AP.Product__c}"/> 
   				</apex:column>
   			</apex:dataTable>
	    </apex:pageBlock>
	</div>
	
    <br/>
    <br />
    
    <div id="fivthDiv" style="{!IF($CurrentPage.parameters.renderas != 'pdf','','border-top-style: solid; border-top-width:1px;')}">
		<apex:pageBlock title="{!$Label.Factsheet_MandatoryProducts}" >
			<apex:dataTable value="{!Mandatory_Products}" var="MP" style="width:100%; height:100%;" rowClasses="odd,even" styleClass="tableClass">
   				<apex:column >
   					<apex:facet name="header">{!$ObjectType.Brand__c.Fields.Name.Label}</apex:facet>
   					<apex:outputText value="{!MP.Brand}"/> 
   				</apex:column>
   				<apex:column >
   					<apex:facet name="header">{!$ObjectType.Product2.Fields.Name.Label}</apex:facet>
   					<apex:outputField value="{!MP.record.Custom_Product__r.Name}"/> 
   				</apex:column>
   				<apex:column >
   					<apex:facet name="header">{!$ObjectType.Mandatory_Products__c.Fields.Product_Status__c.Label}</apex:facet>
   					<apex:outputField value="{!MP.record.Product_Status__c}"/> 
   				</apex:column>
   			</apex:dataTable>
		</apex:pageBlock>
	</div>
   	<br/>
   	<br />
   
   	<div id="sixthDiv" style="{!IF($CurrentPage.parameters.renderas != 'pdf','','border-top-style: solid; border-top-width:1px;')}">
   		<apex:pageBlock title="{!$Label.Factsheet_Promotions}">
   			<apex:dataTable value="{!Promotions}" var="P" cellspacing="2" style="width:100%; height:100%;" rowClasses="odd,even" styleClass="tableClass">
   				<apex:column >
   					<apex:facet name="header">{!$Label.Factsheet_Promotion}</apex:facet>
   					<apex:outputField value="{!P.record.Name}"/> 
   				</apex:column>
   				<apex:column >
   					<apex:facet name="header">{!$Label.Factsheet_Promotion_Activity}</apex:facet>
   					<apex:outputField value="{!P.record.Promotion_Activity__r.Name}"/> 
   				</apex:column>
   				<apex:column >
   					<apex:facet name="header">{!$ObjectType.Promotion__c.Fields.Total_Promotion_Cost__c.Label}</apex:facet>
   					<apex:outputField value="{!P.record.Total_Promotion_Cost__c}"/>
   				</apex:column>
   				<apex:column >
   					<apex:facet name="header">{!$Label.Factsheet_Startdate}</apex:facet>
   					<apex:outputField value="{!P.record.Promotion_Start_Date__c}"/>
   				</apex:column>
   				<apex:column >
   					<apex:facet name="header">{!$Label.Factsheet_Enddate}</apex:facet>
   					<apex:outputField value="{!P.record.Promotion_End_Date__c}"/> 
   				</apex:column>
   				<apex:column >
   					<apex:facet name="header">{!$ObjectType.Promotion__c.Fields.Approval_Status__c.Label}</apex:facet>
   					<apex:outputField value="{!P.record.Approval_Status__c}"/> 
   				</apex:column>
   				<apex:column >
   					<apex:facet name="header">{!$ObjectType.Promotion__c.Fields.status_of_Secondary_placement__c.Label}</apex:facet>
   					<apex:outputField value="{!P.record.status_of_Secondary_placement__c}" rendered="{!P.showStatus}" />
	                <apex:outputText value="" rendered="{!NOT(P.showStatus)}" />
   				</apex:column>
   			</apex:dataTable>
   		</apex:pageBlock>
	</div>
	<br/>
   	<br />
   
	<div id="seventhDiv" style="{!IF($CurrentPage.parameters.renderas != 'pdf','','border-top-style: solid; border-top-width:1px;')}">
		<apex:pageBlock title="{!$Label.Factsheet_PromotionActivities}">
			<apex:dataTable value="{!Promotion_Activity}" var="PA" style="width:100%; height:100%;" rowClasses="odd,even" styleClass="tableClass">
   				<apex:column >
   					<apex:facet name="header">{!$ObjectType.Promotion_Activity__c.Fields.Name.Label}</apex:facet>
   					<apex:outputField value="{!PA.Name}"/>
   				</apex:column>
   				<apex:column >
   					<apex:facet name="header">{!$ObjectType.Promotion_Activity__c.Fields.Description__c.Label}</apex:facet>
   					<apex:outputField value="{!PA.Description__c}"/> 
   				</apex:column>
   			</apex:dataTable>
		</apex:pageBlock>
	</div>
</div>
</apex:page>